@use "../../global"as *;
@use "../globalCooperator-2"as *;

/* -----------------------
  page-chat
----------------------- */
.chat {
  background: rgba(122, 122, 122, 0.75);
  width: 100%;
  height: 100%;

  .header {
    @include iconCover($header);
    width: 100%;
    display: grid;
    position: relative;
    place-items: center left;


    @include pc {
      height: p(73);
      padding-left: p(34);
    }

    @include sp {
      height: smi(60);
      padding-left: smi(20);
    }

    .TL {
      color: $F-FFFFFF;
      @include wt900;

      @include pc {
        font-size: p(23);
      }

      @include sp {
        font-size: smi(20);
      }

      a {
        color: $F-FFFFFF;
        @include wt900;
        cursor: pointer;
        text-decoration: underline;
        line-height: 1.5;

        @include pc {
          font-size: p(23);
        }

        @include sp {
          font-size: smi(20);
        }
      }
    }

    .chat--menu-btn {
      position: absolute;

      @include pc {
        top: p(8);
        right: p(15);
      }

      @include sp {
        top: clamp(1px, calc((3 / 390) * 100vw), 5px);
        right: clamp(2px, calc((5 / 390) * 100vw), 8px);
      }

      .C_all-menu-btn {
        box-shadow: 0px 3.314px 6.629px 0px rgba(0, 0, 0, 0.25);

        @include pc {
          border-radius: p(13.257);
          padding: p(5) p(10) p(6) p(7);
          border-width: p(2);
        }

        @include sp {
          border-radius: clamp(12px, calc((15 / 390) * 100vw), 118px);
          ;
          padding: clamp(1px, calc((3 / 390) * 100vw), 5px) clamp(2px, calc((5 / 390) * 100vw), 8px) clamp(2px, calc((4 / 390) * 100vw), 6px) clamp(2px, calc((5 / 390) * 100vw), 8px);
          ;
          border-width: s(2);
        }

        &__inner {

          @include pc {
            gap: p(5);
          }

          @include sp {
            gap: clamp(1px, calc((3 / 390) * 100vw), 5px);
            ;
          }

          &__img {

            @include pc {
              width: p(50);
              height: p(40);
            }

            @include sp {
              width: clamp(30px, calc((35 / 390) * 100vw), 40px);
              ;
              height: clamp(20px, calc((25 / 390) * 100vw), 30px);
            }
          }

          &__text {

            .TX {
              line-height: 1.5;

              @include pc {
                font-size: p(24);
                letter-spacing: p(1);
              }

              @include sp {
                font-size: clamp(12px, calc((15 / 390) * 100vw), 18px);
              }
            }
          }
        }

        &:hover {
          transform: translate(3.314px, 3.314px);

          @include sp {
            transform: translate(2px, 2px);
          }

          .C_all-menu-btn__inner {

            &__img {
              @include iconContain($all-menu-character-ver2);
            }
          }
        }
      }
    }

  }

  .chat-content {
    position: relative;

    @include pc {
      background: $B-F69064;
      width: p(1182);
      height: calc((569 / 700)* 100%);
      display: flex;
      border-radius: p(15);
      margin: p(41) auto 0;
    }

    @include sp {
      height: calc(546 / 650 * 100%);
      padding-top: s(50);
    }

    .timeline-modal {
      @include pc {
        padding: p(26) p(25) p(69) p(22);
      }

      @include sp {
        display: none;
        height: 100%;
        width: smi(351, 450);
        position: relative;
        margin: 0 auto;
        background: $B-F69064;
        padding: smi(25) smi(15) smi(90, 100);
        border-radius: s(8);
      }

      .timeline-TL {
        position: absolute;
        color: $B-F69064;
        background: $B-FFDFAF;
        border-radius: 20px 20px 20px 0px;
        @include wt800;

        @include pc {
          font-size: p(16);
          letter-spacing: p(1.6);
          padding: p(8) p(15);
          top: p(-15);
          left: 0;
        }

        @include sp {
          font-size: smi(16, 20);
          letter-spacing: smi(1.6);
          padding: smi(8) smi(15);
          top: s(-15);
          left: 0;

        }
      }

      .timeline-wrap {

        @include pc {
          min-width: p(389);
          height: 100%;
        }

        @include sp {
          height: 100%;
        }


        .timeline {
          background: radial-gradient(50% 50% at 50% 50%, rgba(255, 201, 61, 0.00) 0%, rgba(255, 201, 61, 0.13) 100%), #EFFAFF;
          overflow-y: scroll;
          display: flex;
          flex-direction: column;

          @include pc {
            border-radius: p(15);
            height: 100%;
            padding: p(19) p(7);
            gap: p(23);
          }

          @include sp {
            height: 100%;
            border-radius: s(8);
            padding: smi(20) smi(10) smi(85);
            gap: smi(20);
          }

          .timeline-item {
            @include pc {
              padding: 0 p(20) p(12) p(11);
              border-bottom: p(1) solid $F-6D6D6D;
              max-width: p(386);
            }

            @include sp {
              padding: 0 smi(20) smi(12) smi(11);
              border-bottom: s(1) solid $F-6D6D6D;

            }

            h3 {
              @include wt600;
              color: $F-6D6D6D;
              line-height: 1.5;

              @include pc {
                font-size: p(16);
              }

              @include sp {
                font-size: smi(14, 18);
              }
            }

            div {
              @include pc {
                font-size: p(13) !important;
              }

              @include sp {
                font-size: smi(10, 12) !important;
              }
            }

            .like-button-wrap {
              display: flex;
              justify-content: right;

              @include pc {
                gap: p(25);
                margin-top: p(9);
              }

              @include sp {
                gap: smi(28);
                margin-top: smi(5);
              }

              .like-button {
                background-color: $B-FFFFFF;
                border-radius: 50px;
                position: relative;

                @include pc {
                  width: p(32);
                  height: p(32);
                }

                @include sp {
                  width: smi(35, 45);
                  height: smi(35, 45);
                }

                .icon {
                  position: absolute;
                  background-size: contain;
                  background-repeat: no-repeat;
                  top: 50%;
                  left: 50%;
                  translate: -50% -50%;
                  z-index: 2;

                  @include pc {
                    width: p(19);
                    height: p(16);
                  }

                  @include sp {
                    width: smi(19, 25);
                    height: smi(16, 23);

                  }

                }

                .like-TX {
                  white-space: nowrap;
                  color: $F-6D6D6D;
                  position: absolute;
                  left: 50%;
                  translate: -50% 0;

                  @include pc {
                    font-size: p(10);
                    bottom: p(-7);
                  }

                  @include sp {
                    font-size: smi(12, 14);
                    bottom: smi(-5);
                  }

                }

                &.heart {
                  .icon {
                    background-image: heart(encode('#ABABAB'));
                  }

                  &.liked {
                    .icon {
                      background-image: heart(encode('#F29A9A'));
                    }

                    .like-TX {
                      color: #F29A9A;
                    }
                  }
                }

                &.hand {
                  .icon {
                    @include iconContain($hand-before);
                  }

                  &.liked {
                    .icon {
                      @include iconContain($hand-after);
                    }

                    .like-TX {
                      color: #EFC73C;
                    }
                  }
                }

                &.cat {
                  .icon {
                    @include iconContain($cat-before);
                  }

                  &.liked {
                    .icon {
                      @include iconContain($cat-after);
                    }

                    .like-TX {
                      color: #8CCBF5;
                    }
                  }
                }

                &::before {
                  content: "";
                  position: absolute;
                  @include imgContain("like-icon-back.svg");
                  width: 100%;
                  height: 100%;
                  top: 50%;
                  left: 50%;
                  transform: translate(-50%, -50%);
                  z-index: 1;
                  opacity: 0;
                }

                &.click {
                  &::before {
                    animation: like 0.8s ease-out forwards;

                    @keyframes like {

                      0% {
                        opacity: 0;
                        transform: translate(-50%, -50%);
                      }

                      50% {
                        opacity: 1;
                        transform: translate(-50%, -50%) scale(1.1);
                      }

                      100% {
                        opacity: 0;
                        transform: translate(-50%, -50%) scale(1.2);
                      }
                    }
                  }
                }
              }

            }

          }
        }

        .C_reaction {
          display: flex;

          @include pc {
            margin-top: p(12);
            gap: p(12);
          }

          @include sp {
            margin-top: smi(12);
            gap: smi(12);

          }

          .coin-counter {
            background: $B-FFFFFF;
            display: flex;
            align-items: center;
            width: fit-content;

            @include pc {
              border-radius: p(20);
              padding: p(4) p(16) p(4) p(10);
            }

            @include sp {
              border-radius: s(50);
              padding: smi(5) smi(15) smi(5) smi(10);
            }

            .icon {
              @include imgContain("/log-board/log-board-item-02.webp");

              @include pc {
                width: p(36);
                height: p(36);
              }

              @include sp {
                width: smi(30);
                height: smi(30);
              }
            }

            .number {
              color: $B-F69064;
              @include wt800;

              @include pc {
                font-size: p(26);
                margin-left: p(7);
              }

              @include sp {
                font-size: smi(22, 25);
                margin-left: smi(5);
              }
            }

          }

          .textbox {
            .TX {

              @include pc {
                font-size: p(16);
              }

              @include sp {
                font-size: smi(16, 20);
              }
            }

            .reaction-counter {
              @include pc {
                font-size: p(16);
                margin-top: p(5);
              }

              @include sp {
                font-size: smi(16, 18);
                margin-top: smi(3);
              }
            }
          }

        }

        .chat-back {
          display: flex;
          align-items: center;
          margin: smi(5) 0 0 smi(5, 10);

          .icon {
            @include iconContain($back-arrow);
            width: smi(23, 33);
            height: smi(25, 35);
          }

          .TX {
            @include wt800;
            color: $F-857763;
            font-size: smi(12, 14);
          }
        }
      }

      &.show {
        @include sp {
          display: block;
        }
      }
    }

    .chat-wrap {
      background: $B-4BC7FB;
      position: relative;

      @include pc {
        border-radius: p(15);
        padding: p(19) p(21) p(69);
        flex: 1;
      }

      @include sp {
        width: smi(351, 450);
        height: 100%;
        margin: 0 auto;
        border-radius: s(8);
        padding: smi(15) smi(15) smi(60);

      }

      .chat-TL {
        @include iconContain($cover-ribbon);
        position: absolute;
        left: 50%;
        translate: -50% 0;
        z-index: 10;

        @include pc {
          width: p(580);
          height: p(123);
          padding-top: p(30);
          top: p(-35);
        }

        @include sp {
          width: smi(322, 400);
          height: smi(67, 85);
          top: smi(-20);
          padding-top: smi(12, 18);
        }

        .TL {
          color: $F-C7B82F;
          text-align: center;
          @include wt900;

          @include pc {
            font-size: p(30);
            letter-spacing: p(1.3);
          }

          @include sp {
            font-size: smi(20, 24);
            letter-spacing: s(1.3);
          }
        }
      }

      #simple-ajax-chat {
        height: 100%;

        #sac-output {
          background: radial-gradient(50% 50% at 50% 50%, rgba(61, 255, 255, 0.00) 0%, rgba(61, 255, 255, 0.13) 100%), #EFFAFF;
          box-shadow: 0px 0px 20px 0px rgba(0, 0, 0, 0.25) inset;
          width: 100%;
          height: 100%;

          @include pc {
            padding: p(90) p(50) p(20) p(45);
            border-radius: p(15);
          }

          @include sp {
            border-radius: s(8);
            padding: smi(44) smi(10) smi(85);
          }

          #sac-latest-message {
            display: none;
          }
        }

        #sac-panel {
          float: none;
          position: absolute;
          bottom: 0;

          @include sp {
            width: 100%;
          }

          #sac-form {
            display: flex;
            align-items: center;

            @include pc {
              gap: p(20);
              margin-bottom: p(5);
            }

            @include sp {
              gap: s(8);
              margin-bottom: smi(5);
            }

            #sac-user-info {
              display: none;
            }

            #sac-user-chat {
              margin-bottom: 0;

              label {
                display: none;

              }

              #sac_chat {
                border: none;
                float: none;
                outline: none;
                position: relative;
                display: border-box;

                @include pc {
                  width: p(540);
                  height: p(25);
                  border-radius: p(10);
                  padding: p(11) p(24);
                  font-size: p(16);
                }

                @include sp {
                  width: calc((282 /351)*100%);
                  height: smi(29);
                  border-radius: s(5);
                  padding: s(5) s(10);
                  font-size: smi(16);
                }

                &::placeholder {
                  font-size: 0;
                }
              }
            }

            #sac-user-submit {
              position: relative;
              background: linear-gradient(0deg, rgba(75, 199, 251, 0.00) 0%, #5DCFFF 100%), #307DF1;
              box-shadow: 0px 4px 4px 0px rgba(255, 255, 255, 0.54) inset, 0px 2px 3px 0px #3C5C8A;

              @include pc {
                min-width: p(92);
                height: p(45);
                border-radius: p(30);
              }

              @include sp {
                width: s(40);
                height: s(19);
                border-radius: s(15);
                right: smi(35);
              }

              .submit {
                opacity: 0;
                cursor: pointer;
                width: 100%;
                height: 100%;
              }

              &::before {
                content: "";
                @include iconContain($chat-plant);
                pointer-events: none;
                position: absolute;
                display: block;
                z-index: 20;
                left: 50%;
                top: 50%;
                translate: -50% -50%;

                @include pc {
                  width: p(38);
                  height: p(38);
                }

                @include sp {
                  width: s(18);
                  height: s(18);
                }
              }

            }

            &::before {
              content: "コメントを入力する";
              position: absolute;
              pointer-events: none;
              z-index: 10;
              color: $F-D2D2D2;
              @include wt800;

              @include pc {
                font-size: p(16);
                padding: p(11) p(24);
              }

              @include sp {
                font-size: smi(14);
                padding-left: smi(10);
              }
            }

            &.input-has-value {
              &::before {
                display: none;
              }
            }
          }

        }

        #sac-messages {
          display: flex;
          flex-direction: column;
          position: relative;


          .sac-chat-message {
            position: relative;

            .chat-avatar {
              overflow: hidden;

              @include pc {
                width: p(53);
                height: p(53);
                border: $F-C7B82F solid p(2);
                padding-top: p(8);
                border-radius: p(5);
              }

              @include sp {
                width: smi(33, 43);
                height: smi(33, 43);
                border: $F-C7B82F solid s(1.5);
                padding-top: smi(5);
                border-radius: smi(5);
              }
            }

            &.sac-user- {
              &::before {
                content: "";
                @include imgContain("staff-icon.webp");
                display: block;

                @include pc {
                  width: p(53);
                  height: p(53);
                }

                @include sp {
                  width: smi(33, 43);
                  height: smi(33, 43);
                }
              }

            }


            .sac-chat-name-wrap {
              position: absolute;
              overflow: hidden;
              top: 0;



              @include pc {
                left: p(73);
                height: p(23);
              }

              @include sp {
                top: smi(-3);
                left: smi(50, 65);
              }

              .sac-chat-name {
                display: block;
                color: $F-857763;
                @include wt800;

                @include pc {
                  white-space: nowrap;
                  font-size: p(16);
                  letter-spacing: p(1.6);
                  margin-right: p(-10);
                }

                @include sp {
                  font-size: smi(12, 14);
                  letter-spacing: s(1);
                  margin-right: smi(-8);

                }
              }
            }

            .highlight-text {
              color: $F-B29975;
              position: relative;
              // @include iconCover($chat-bubble);
              @include wt600;
              display: grid;
              place-items: center left;
              background-color: $B-FFFFFF;
              line-height: 1.2;
              filter: drop-shadow(0px 3px 5px rgba(0, 0, 0, 0.15));

              @include pc {
                width: p(460);
                font-size: p(16);
                padding: p(8) p(30);
                top: p(-30);
                left: p(70);
                border-radius: p(5);
              }

              @include sp {
                width: smi(220, 308);
                font-size: smi(12, 16);
                top: s(-15);
                left: smi(50, 60);
                padding: smi(8, 10) smi(15, 20);
                border-radius: smi(3);
              }

              &::before {
                content: "";
                clip-path: polygon(75% 0, 100% 100%, 10% 100%);
                background: $B-FFFFFF;
                position: absolute;
                bottom: 0;

                @include pc {
                  width: p(27);
                  height: p(16);
                  left: p(-12);
                }

                @include sp {
                  width: 20px;
                  height: 12px;
                  left: -7px;
                }
              }
            }

            &.me {
              .sac-chat-name-wrap {
                left: auto;

                @include pc {
                  right: p(73);
                }

                @include sp {
                  right: smi(50, 65);
                }

                .sac-chat-name {
                  color: $P-F6AA64;
                }
              }

              .highlight-text {
                // @include iconCover($chat-me);
                color: $P-F6AA64;
                place-items: center right;
                left: auto;
                background: $B-FFFDED;


                @include pc {
                  right: p(-50);
                }

                @include sp {
                  right: smi(-5, -15);
                }

                &::before {
                  content: "";
                  clip-path: polygon(10% 0%, 100% 100%, 10% 100%);
                  background: $B-FFFDED;
                  position: absolute;
                  bottom: 0;

                  @include pc {
                    width: p(27);
                    height: p(16);
                    right: p(-12);
                    left: initial;
                  }

                  @include sp {
                    right: -6px;
                    left: initial;
                  }
                }

              }

              .chat-avatar {
                margin-left: auto;
              }
            }
          }
        }
      }

      .C_reaction {
        background: $B-F69064;
        width: fit-content;
        border-radius: smi(10);
        padding: smi(5) smi(15);
        position: absolute;
        bottom: smi(75);
        right: smi(30);

        .textbox {
          .reaction-counter {
            margin-top: smi(5);
          }
        }

        .coin-counter {
          margin-left: auto;
          margin-top: smi(-10);
        }
      }

      &.show {
        @include sp {
          display: none;
        }
      }
    }
  }
}


#sac-latest-message {
  font-size: 0px !important;

  &::before {
    content: "チャットのタイトル";
    font-size: 14px;
  }
}

/* group_aユーザーにはgroup_bとgroup_cのメッセージを非表示 */
.group_a_user {

  .group_b,
  .group_c {
    display: none;
  }
}

/* group_bユーザーにはgroup_aとgroup_cのメッセージを非表示 */
.group_b_user {

  .group_a,
  .group_c {
    display: none;
  }
}

/* group_cユーザーにはgroup_aとgroup_bのメッセージを非表示 */
.group_c_user {

  .group_a,
  .group_b {
    display: none;
  }
}

#sac-output {
  background-color: rgb(255 255 255 / 0.5);
}

#sac-messages {
  opacity: 0; // Initially hide the element
  animation: showMessage 0s 0.3s forwards; // Apply animation
}

@keyframes showMessage {
  to {
    opacity: 1;
  }
}




// // 他のページに新着メッセージ表示させるとき
// #simple-ajax-chat{
//   display: none;
// }
// #latest-messages{
//   z-index: 999;
//   position: relative;
// }